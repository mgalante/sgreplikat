define(['plugins/router', 'durandal/app'], function (router, app) {
    return {
        router: router,
        search: function() {
            //It's really easy to show a message box.
            //You can add custom options too. Also, it returns a promise for the user's response.
            app.showMessage('Search not yet implemented...');
        },
        activate: function () {
            router.map([
                { route: '', title:'Welcome', moduleId: 'viewmodels/welcome', nav: true },
				<% for(var i in modules) { %>
				{ route: '<%=modules[i].module%>/list', title:'<%=_.str.capitalize(modules[i].modules)%>', moduleId: 'viewmodels/<%=modules[i].module%>/list', nav: true },
                { route: '<%=modules[i].module%>/edit/:id', title:'Editar <%=_.str.capitalize(modules[i].module)%>', moduleId: 'viewmodels/<%=modules[i].module%>/edit', nav: false },
                { route: '<%=modules[i].module%>/create', title:'Crear <%=_.str.capitalize(modules[i].module)%>', moduleId: 'viewmodels/<%=modules[i].module%>/create', nav: false },
				<% } %>
                { route: 'account/login', title:'Login', moduleId: 'viewmodels/account/login', nav: true },
                { route: 'account/logout', title:'X', moduleId: 'viewmodels/account/logout', nav: true }				
            ]).buildNavigationModel();
            
            return router.activate();
        }
    };
});